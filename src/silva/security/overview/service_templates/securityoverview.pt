<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/@@standard_macros/page">
  <body>
    <div metal:fill-slot="body">
      <style>
        .hilite { background-color: Yellow;}
        .results tr:nth-child(even) td { background-color: #eee;}
        .results th { text-align: left;}
        .nav { padding: 5px;}    
        .batchNav a { border: 1px solid; padding:1px 2px;}
        .batchNav a.current, .batchNav a.next, .batchNav a.previous { border: none;}
      </style>
      <form action="." tal:attributes="action view/form_path" method="get"
            enctype="multipart/form-data">

        <h2 tal:condition="view/label"
            tal:content="view/label">Label</h2>

        <p tal:condition="view/description"
           tal:content="view/description">Description</p>

        <p class="system-msg"
           tal:condition="view/status"
           tal:content="view/status">Status</p>

        <p class="system-msg"
           tal:condition="view/errors">
          <tal:error tal:repeat="error view/formErrors">
            <span tal:replace="error/title" />
          </tal:error>
        </p>

        <table class="fields"
               tal:condition="view/fieldWidgets">
          <tr class="field" tal:repeat="widget view/fieldWidgets">
            <td>
              <label class="field-label form-label" for="#"
                     tal:attributes="for widget/htmlId"
                     tal:content="widget/title">
                Label
              </label>
              <span class="field-required form-optional"
                    tal:condition="widget/required">(required)</span>
            </td>
            <td>
              <tal:widget tal:content="structure widget/render" />
            </td>
            <td>
              <tal:description tal:condition="widget/description">
                <span class="field-description form-help"
                      tal:content="widget/description">
                  </span><br />
              </tal:description>
            </td>
            <td>
              <tal:error tal:define="error widget/error"
                         tal:condition="error">
                <span class="field-error"
                      tal:content="error/title">
                  Error
                </span>
                <br />
              </tal:error>
            </td>
          </tr>
        </table>
      
        <div class="actions"
             tal:condition="view/actionWidgets">
          <div class="action" tal:repeat="widget view/actionWidgets">
            <tal:widget tal:content="structure widget/render" />
          </div>
        </div>

      </form>

      <p class="message" tal:condition="python: not(view.entries)">
        No search results.
      </p>

      <tal:block tal:condition="view/entries">

        <div class="nav" tal:content="structure view/batch" />

        <table style="width: 100%;" class="results">
          <tr class="list-header">
            <th><div class="list-item">User</div></th>
            <th><div class="list-item">Role</div></th>
            <th><div class="list-item">Container path</div></th>
          </tr>
          <tal:block tal:repeat="entry view/entries">
             <tal:block tal:repeat="data python: view.unpack_entry(entry)">
              <tr class="row-normal list-item">
                <td style="width: 15%;">
                  <span tal:content="python:data['user']"
                        tal:attributes="class python:'user' in data['hilite'] and 'hilite' or ''" />
                </td>
                <td style="width: 15%;">
                  <span tal:content="python:data['role']"
                        tal:attributes="class python:'role' in data['hilite'] and 'hilite' or ''" />
                </td>
                <td style="width: 80%;">
                  <a 
                    tal:attributes="href python: view.smi_security_url(entry)"
                    tal:content="python: '/'.join(entry.getPhysicalPath())" />
                </td>
              </tr>
            </tal:block>
           </tal:block>
        </table>
        
        <div class="nav" tal:content="structure view/batch" />

      </tal:block>
    </div>
  </body>
</html>
